[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Simon’s notebook",
    "section": "",
    "text": "About this blog"
  },
  {
    "objectID": "posts/swab-sampling/index.html",
    "href": "posts/swab-sampling/index.html",
    "title": "Pooled swab sampling for pathogen early detection",
    "section": "",
    "text": "Code\n# Importing packages\nimport seaborn as sns\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom collections import defaultdict\nimport random\nimport math"
  },
  {
    "objectID": "posts/swab-sampling/index.html#pathogen-shedding",
    "href": "posts/swab-sampling/index.html#pathogen-shedding",
    "title": "Pooled swab sampling for pathogen early detection",
    "section": "Pathogen shedding",
    "text": "Pathogen shedding\nAmong many types of pathogens, respiratory pathogens are particularly likely to cause future pandemics (Amesh A. Adalja, MD, Matthew Watson, …). Though different pathogens have different tropism across tissues (SARS-CoV-2 having a wider wider tropism than influenza (Flerlage et al. 2021)), all of them are respiratory pathogens and thus shed in the respiratory tract, which includes the pharynx, mouth, and nose.\nIn a swab sampling program we could use different swabs that target any of these sitesm, i.e., the nostrils, the nasopharynx, oropharynx, and the mid-turbinate region1. These sites differ in their comfort of sampling and (probably) in their sensitivity. For instance, nasopharyngeal swabs (NP swabs) would have be far better than other swabs for us to consider them for a sampling program, given that they do not allow self-sampling.\nWe will evaluate the performance of different swab types in three ways:\n\nSensitivity: Is the pathogen present at all?\nViral load: How much of the pathogen can be measured? This metric is based on the qPCR cycle threshold of quantiative.\nRelative abundance: When performing untargeted sequencing, what is the relative abundance of a pathogen?\n\n\nSensitivity of different swab types\n(Tsang et al. 2021) performed a meta-analysis to evaluate the ability of different swab types in detecting SARS-CoV-2 using qPCR. Swab types included nasal swabs (n=1622), throat swabs (n=388), and pooled nasal and throat swabs (n=719), each of which were compared to nasopharyngeal swabs. Overall, pooled nasal/throat swabs have the best diagnostic performance with sensitivity of 0.97 (0.93-1.00).\n\nTable 1: Comparison of different swab sample types. Adapted from (Tsang et al. 2021). Values are effect sizes under a random effects-model. The gold standard is nasopharyngeal swabs.\n\n\n\n\n\n\n\n\n\nSample Type\nSensitivity\nSpecificity\nPositive Predictive Value\nNegative Predictive Value\n\n\n\n\nNasal swabs (n=1622)\n0.86 (0.77-0.93)\n0.99 (0.96-1.00)\n0.96 (0.87-1.00)\n0.95 (0.88-0.99)\n\n\nThroat swabs (n=388)\n0.68 (0-35-0.94)\n0.97 (0.95-0.99)\n0.75 (0.45-0.96)\n0.96 (0.94-0.98)\n\n\nPooled nasal/throat swabs (n=719)\n0.97 (0.93-1.00)\n0.99 (0.98-1.00)\n0.97 (0.90-1.00)\n0.99 (0.98-1.00)\n\n\n\nNote, though Tsang et al. 2021 reports specificity, this metric isn’t very useful in this context. All studies covered by the review used qPCR to detect SARS-CoV-2. qPCR is generally considered to be very sensitive and specific. Thus, if a patient tests positive in a throat swab qPCR, but negative in nasopharyngeal swab qPCR, this shouldn’t be counted against throat swabs (false positive), but rather against nasopharyngeal swabs.\nThe review above gives us binary information about SARS-CoV-2 being present in different swab types. But we are not merely interested in a pathogen being present in a sample, but how abundant said pathogen is. For instance, hroat swabs coming back negative when NP swabs come back positive tells us that pathogen abundance is likely higher in the nasopharynx, but it’s unclear by how much.\nGetting a better understanding of this is particularly relevant when pooling samples because higher relative abundance in an individual positive sample will ensure detection even if said sample is pooled with a large number of negative samples. To quantify this difference in absolute pathogen abundance between sample types we can look beyond positive/negative comparisons and instead look at the differences in CT scores within studies that compared swab types.\n\n\nViral load in different swab types\n\nNasopharyngeal swabs\nMost studies on swab sampling performance treat nasopharyngeal swabs (NP swabs) as the gold standard, against which, nasal (Kojima et al. 2021; Tu et al. 2020), mid-turbinate (Tu et al. 2020; Muller et al. 2021), and combined nasal/oropharyngeal (Desmet et al. 2021) swabs are compared. NP swabs are commonly administered by a healthcare professional and a properly administered test absorbs material from below the inferior turbinate, and the nasopharynx located at the back of the nasal cavity.\nThe CT value difference for paired NP/{Other} swabs are plotted in Figure 1. The CT value of the comparison swab is subtracted from the NP swab CT value. A lower CT is better, thus, a negative cycle threshold (CT) difference equates to a higher pathogen concentration in the NP swab.\n\n\nCode\n# All CT difference data were calculated in and are taken from https://docs.google.com/spreadsheets/d/1YP4mxT_vxiFwXU5ZuBM4obq_oscfhe05ODWwHFHEznM/\ndf = pd.read_csv(\"data/np_ct_differences.tsv\", sep=\"\\t\", skiprows=1)\ndf.columns = df.columns.str.replace(\", \", \"\\n\")\n\ndf = df.melt(var_name=\"Study & Comparison\", value_name=\"CT Difference\")\n\nfig = plt.figure(figsize=(8, 3.5))\nsns.stripplot(\n    data=df,\n    y=\"Study & Comparison\",\n    x=\"CT Difference\",\n    hue=\"Study & Comparison\",\n    jitter=True,\n)\nplt.legend([], [], frameon=False)\n# drop y axis label\nplt.ylabel(\"\")\nplt.xlabel(\"qPCR Cycle Threshold Value Difference\")\nplt.tick_params(axis=\"y\", which=\"both\", left=False, right=False, labelleft=True)\nfor x in 5, 0, -5, -10, -15:\n    if x == 0:\n        plt.axvline(x=x, color=\"red\", linestyle=\"--\", alpha=0.5)\n        continue\n    plt.axvline(x=x, color=\"grey\", linestyle=\"--\", alpha=0.5, linewidth=0.5)\n\nfor y in 0.5, 1.5, 2.5, 3.5, 4.5:\n    plt.axhline(y=y, color=\"grey\", linestyle=\"--\", alpha=0.5, linewidth=0.5)\n\nmin_x, max_x = plt.xlim()\n\nplt.text(max_x / 2, -0.6, \"Favors Comparison\", fontsize=10, color=\"black\", ha=\"center\")\nplt.text(min_x / 2, -0.6, \"Favors NP Swab\", fontsize=10, color=\"black\", ha=\"center\")\n\nplt.gca().spines[\"right\"].set_visible(False)\nplt.gca().spines[\"top\"].set_visible(False)\nplt.gca().spines[\"left\"].set_visible(False)\nplt.show()\n\n\n\n\n\nFigure 1: Nasopharyngeal vs Nasal, Mid-Turbinate, and combined Oropharyngeal/ Nasal swabs. Data from Kojima et al. 2020, Tu et al. 2020, Muller et al. 2021, and Desmet et al. 2021.\n\n\n\n\nApart from self-collected mid-turbinate swabs in Tu et al. 2020, NP swabs show equivalent performance to nasal swabs in Kojima et al. 2020, mid-turbinate swabs in Muller et al. 2021, and combined nasal/throat swabs in Desmet et al 2021; and equivalent performance to nasal swabs in Tu et al. 2020. In the same study, nasal swabs prove equivalent to NP swabs. Combined oro-pharyngeal swabs are also equivalent to NP swabs.\nStudies that use NP swabs as their gold standard are useful to better understand the performance of other swab types, but NP swabs themselves are not practical for a large-scale pooled sampling programs: NP swabs are notoriously uncomfortable and are commonly administered by a third person. In contrast, nasal or oropharyngeal swabs would be more suitable for self-sampling, which allows far higher testing throughput. Let’s thus look at studies that compare nasal and oropharyngeal swabs.\n\n\n\nNasal Swabs\nNote that the second plot shows the difference in genome copy numbers, rather than CT values2.\n\n\nCode\ndf = pd.read_csv(\"data/nasal_ct_differences.tsv\", sep=\"\\t\", skiprows=1)\n\ndf.columns = df.columns.str.replace(\", \", \"\\n\")\n# reshape dataframe to long format\ndf = df.melt(var_name=\"Study & Comparison\", value_name=\"CT Difference\")\n\n\nfig = plt.figure(figsize=(8, 1.5))\nsns.stripplot(\n    data=df,\n    y=\"Study & Comparison\",\n    x=\"CT Difference\",\n    hue=\"Study & Comparison\",\n    jitter=True,\n)\nplt.legend([], [], frameon=False)\n# drop y axis label\nplt.ylabel(\"\")\nplt.xlabel(\"qPCR Cycle Threshold Value Difference\")\nplt.tick_params(axis=\"y\", which=\"both\", left=False, right=False, labelleft=True)\n\nfor x in 5, 0, -5, -10, -15:\n    if x == 0:\n        plt.axvline(x=x, color=\"red\", linestyle=\"--\", alpha=0.5)\n        continue\n    plt.axvline(x=x, color=\"grey\", linestyle=\"--\", alpha=0.5, linewidth=0.5)\n\nplt.axhline(y=0.5, color=\"grey\", linestyle=\"--\", alpha=0.5, linewidth=0.5)\n\nmin_x, max_x = plt.xlim()\n\nplt.text(max_x / 2, -0.6, \"Favors Comparison\", fontsize=10, color=\"black\", ha=\"center\")\nplt.text(min_x / 2, -0.6, \"Favors Nasal Swab\", fontsize=10, color=\"black\", ha=\"center\")\n\n\nplt.gca().spines[\"right\"].set_visible(False)\nplt.gca().spines[\"top\"].set_visible(False)\nplt.gca().spines[\"left\"].set_visible(False)\n\nplt.show()\n\n\n\n\n\nFigure 2: Nasal swabs vs Oro-pharyngeal and combined nasal/oro-pharyngeal swabs. All data is taken from Goddall et al. 2022.\n\n\n\n\n\n\nCode\n# All CT difference data was calculated and is taken from https://docs.google.com/spreadsheets/d/1YP4mxT_vxiFwXU5ZuBM4obq_oscfhe05ODWwHFHEznM/\n\n# turn tsv into dataframe. Ignore first row. Second row is column names.\ndf = pd.read_csv(\"data/leung_genome_copy_differences.tsv\", sep=\"\\t\", skiprows=1)\n\n\ndf = df.melt(var_name=\"Study & Comparison\", value_name=\"Genome Copy Number Difference\")\n\ndf[\"Study & Comparison\"] = df[\"Study & Comparison\"].str.split(\",\").str[-1]\nfig = plt.figure(figsize=(8, 2))\nsns.stripplot(\n    data=df,\n    y=\"Study & Comparison\",\n    x=\"Genome Copy Number Difference\",\n    hue=\"Study & Comparison\",\n    jitter=True,\n)\nplt.legend([], [], frameon=False)\n# drop y axis label\nplt.ylabel(\"\")\nplt.xlabel(\"Genome Copy Number Difference (Nasal - Throat Swabs), log10 scale\")\n# flip x axis\nplt.gca().invert_xaxis()\nplt.tick_params(axis=\"y\", which=\"both\", left=False, right=False, labelleft=True)\nfor x in -2, 0, 2, 4, 6:\n    if x == 0:\n        plt.axvline(x=x, color=\"red\", linestyle=\"--\", alpha=0.5)\n        continue\n    plt.axvline(x=x, color=\"grey\", linestyle=\"--\", alpha=0.5, linewidth=0.5)\n\nfor y in 0.5, 1.5:\n    plt.axhline(y=y, color=\"grey\", linestyle=\"--\", alpha=0.5, linewidth=0.5)\n\nmin_x, max_x = plt.xlim()\n\nplt.text(max_x / 2, -0.6, \"Favors Throat Swab\", fontsize=10, color=\"black\", ha=\"center\")\nplt.text(min_x / 2, -0.6, \"Favors Nasal Swab\", fontsize=10, color=\"black\", ha=\"center\")\n\nplt.gca().spines[\"right\"].set_visible(False)\nplt.gca().spines[\"top\"].set_visible(False)\nplt.gca().spines[\"left\"].set_visible(False)\n\nplt.show()\n\n\n\n\n\nFigure 3: Nasal swabs vs Oro-pharyngeal swabs. All data is taken from Leung et al. 2020.\n\n\n\n\nIn qPCR measurements, nasal swabs contain more virus copies than throat swabs. In (Goodall et al. 2022), nasal swabs are slightly superior to throat swabs and combined/nasal throat swabs, and come out about even when compared to combined nasal/OP swabs. In (Leung et al. 2020), researchers ran multiplex-PCR on both nasal and throat swamples. qPCR differences are plotted in Figure 3 for Human Coronavirus, Influenza, and Rhinovirus."
  },
  {
    "objectID": "posts/swab-sampling/index.html#footnotes",
    "href": "posts/swab-sampling/index.html#footnotes",
    "title": "Pooled swab sampling for pathogen early detection",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nThe shedding dynamics of a stealth pathogen are likely to be different from SARS-CoV-2, so we need to be careful about generalizing from samples that originate from SARS-CoV-2 patients, particularly if they are hospitalized.↩︎\nA 1-log difference in genome copy number is equivalent to a 3.3 CT difference. This is because each cycle in a qPCR machine approxiately equates to doubling of the genome copy number.↩︎\nThe shedding dynamics of a stealth pathogen are likely to be different from SARS-CoV-2, so we need to be careful about generalizing from samples that originate from SARS-CoV-2 patients, particularly if they are hospitalized.↩︎\nSee McClaren et al. 2019 for further discussion.↩︎"
  },
  {
    "objectID": "posts/quarto-test/index.html",
    "href": "posts/quarto-test/index.html",
    "title": "Test Quarto Markdown",
    "section": "",
    "text": "I turned on the table of contents in the YAML front matter. It should automatically show up on the right side of the blog post, staying there while scrolling up and down the blog post."
  },
  {
    "objectID": "posts/quarto-test/index.html#text-formatting",
    "href": "posts/quarto-test/index.html#text-formatting",
    "title": "Test Quarto Markdown",
    "section": "Text Formatting",
    "text": "Text Formatting\nHere are various text formatting options in Quarto:\n\n\nItalics, bold, and bold italics\n\nSuperscript2 and subscript2\n\nStrikethrough\nVerbatim code"
  },
  {
    "objectID": "posts/quarto-test/index.html#headings",
    "href": "posts/quarto-test/index.html#headings",
    "title": "Test Quarto Markdown",
    "section": "Headings",
    "text": "Headings\nDemonstration of heading levels in Quarto:"
  },
  {
    "objectID": "posts/quarto-test/index.html#header-2",
    "href": "posts/quarto-test/index.html#header-2",
    "title": "Test Quarto Markdown",
    "section": "Header 2",
    "text": "Header 2\nHeader 3\nHeader 4\nHeader 5\nHeader 6"
  },
  {
    "objectID": "posts/quarto-test/index.html#written-text",
    "href": "posts/quarto-test/index.html#written-text",
    "title": "Test Quarto Markdown",
    "section": "Written Text",
    "text": "Written Text\nLorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."
  },
  {
    "objectID": "posts/quarto-test/index.html#lists",
    "href": "posts/quarto-test/index.html#lists",
    "title": "Test Quarto Markdown",
    "section": "Lists",
    "text": "Lists\n\nunordered list\n\nsub-item 1\nsub-item 2\n\nanother item\n\n\n\n\n\n\nordered list\nitem 2\n\nsub-item 1\n\nsub-sub-item 1"
  },
  {
    "objectID": "posts/quarto-test/index.html#math",
    "href": "posts/quarto-test/index.html#math",
    "title": "Test Quarto Markdown",
    "section": "Math",
    "text": "Math\nInline math: \\(E = mc^{2}\\)\nDisplay math:\n\\[E = mc^{2}\\]"
  },
  {
    "objectID": "posts/quarto-test/index.html#quotes",
    "href": "posts/quarto-test/index.html#quotes",
    "title": "Test Quarto Markdown",
    "section": "Quotes",
    "text": "Quotes\nHere is a quote:\n\n“This is a quote.”"
  },
  {
    "objectID": "posts/quarto-test/index.html#showing-a-png",
    "href": "posts/quarto-test/index.html#showing-a-png",
    "title": "Test Quarto Markdown",
    "section": "Showing a png",
    "text": "Showing a png\nHere is a figure with 100% width (it should be the same width as the text)  Here is a figure with 50% width.\n\n\nExample Figure at 50% Size\n\nHere is a paragraph of text for comparison:\nLorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."
  },
  {
    "objectID": "posts/quarto-test/index.html#figure-with-python",
    "href": "posts/quarto-test/index.html#figure-with-python",
    "title": "Test Quarto Markdown",
    "section": "Figure with Python",
    "text": "Figure with Python\nHere is a figure created in Python:\n\nCodeimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.stats import gamma\n\nx = np.linspace(0, 20, 400)  # x values\na1, b1 = 1, 0.1  # Exponential curve 1 parameters\na2, b2 = 1, 0.2  # Exponential curve 2 parameters\nk, theta = 2, 2  # Gamma distribution parameters\n\nexp_curve1 = a1 * np.exp(b1 * x)\nexp_curve2 = a2 * np.exp(b2 * x)\n\n\nplt.figure(figsize=(10, 6))\nplt.plot(x, exp_curve1, label=\"Exponential Curve 1: a=1, b=0.1\", color=\"blue\")\nplt.plot(x, exp_curve2, label=\"Exponential Curve 2: a=1, b=0.2\", color=\"green\")\nplt.title(\"Example Figure\")\nplt.xlabel(\"x\")\nplt.ylabel(\"y\")\nplt.legend()\nplt.grid(True)\nplt.show()\n\n\n\nFigure Caption: Example figure with two exponential curves."
  },
  {
    "objectID": "posts/quarto-test/index.html#figure-with-r",
    "href": "posts/quarto-test/index.html#figure-with-r",
    "title": "Test Quarto Markdown",
    "section": "Figure with R",
    "text": "Figure with R\nHere is a figure created in R:\n\nCodemtcars2 &lt;- mtcars\nmtcars2$am &lt;- factor(\n  mtcars$am, labels = c('automatic', 'manual')\n)\nlibrary(ggplot2)\nggplot(mtcars2, aes(hp, mpg, color = am)) +\n  geom_point() +\n  geom_smooth(formula = y ~ x, method = \"loess\") +\n  theme(legend.position = 'bottom')"
  },
  {
    "objectID": "posts/quarto-test/index.html#footnotes",
    "href": "posts/quarto-test/index.html#footnotes",
    "title": "Test Quarto Markdown",
    "section": "Footnotes",
    "text": "Footnotes\n\nThis is the first footnote.↩︎\nThis is the second footnote.↩︎"
  },
  {
    "objectID": "posts/quarto-test/index.html#asides",
    "href": "posts/quarto-test/index.html#asides",
    "title": "Test Quarto Markdown",
    "section": "Asides",
    "text": "Asides\nAsides are a feature by Quarto where you can put text on the right side or left side of your main body of text.\nAside with Latex\nHere is an aside with Latex.\n\n\nWe know from the first fundamental theorem of calculus that for \\(x\\) in \\([a, b]\\):\n\\[\\frac{d}{dx}\\left( \\int_{a}^{x} f(u)\\,du\\right)=f(x).\\]\nAside with a figure\nHere is an aside with a figure. We will probably use this quite rarely.\n\nCodemtcars2 &lt;- mtcars\nmtcars2$am &lt;- factor(\n  mtcars$am, labels = c('automatic', 'manual')\n)\nlibrary(ggplot2)\nggplot(mtcars2, aes(hp, mpg, color = am)) +\n  geom_point() +\n  geom_smooth(formula = y ~ x, method = \"loess\") +\n  theme(legend.position = 'bottom')\n\n\n\n\n\n\n\nFull page figure\nHere is a full page figure, that uses the entire width of the web browser. Here some text for reference:\nLorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\nCodeplot(cars)\nplot(iris)\nplot(pressure)"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Simon’s NAO Notebook",
    "section": "",
    "text": "Test Quarto Markdown\n\n\n\n\n\n\n\n\n\n\n\nFeb 27, 2024\n\n\nSimon Grimm\n\n\n\n\n\n\n\n\n\n\n\n\nPooled swab sampling for pathogen early detection\n\n\n\n\n\n\n\n\n\n\n\nFeb 23, 2024\n\n\nSimon Grimm\n\n\n\n\n\n\nNo matching items"
  }
]